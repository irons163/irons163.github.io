<!DOCTYPE html>
<html lang="en-us">
    
  <head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.82.0" />

    

<title>Phil Chang</title>


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Welcome"/>
<meta name="twitter:description" content=""/>

<meta property="og:title" content="Welcome" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://irons163.github.io/" />



    


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">








<link rel="stylesheet" href="/scss/hyde-hyde.71157e768c4e111a23c3531b95e0cbb59bbef3c9e6901d36247cb53d6b6be258.css" integrity="sha256-cRV&#43;doxOERojw1MbleDLtZu&#43;88nmkB02JHy1PWtr4lg=">


<link rel="stylesheet" href="/scss/print.2744dcbf8a0b2e74f8a50e4b34e5f441be7cf93cc7de27029121c6a09f9e77bc.css" integrity="sha256-J0Tcv4oLLnT4pQ5LNOX0Qb58&#43;TzH3icCkSHGoJ&#43;ed7w=" media="print">



    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/favicon.png">
    <link rel="alternate" type="application/rss+xml" href="https://irons163.github.io/index.xml" title="Phil Chang" />

    

</head>


    <body class=" ">
    
<div class="sidebar">
  <div class="container ">
    <div class="sidebar-about">
      <span class="site__title">
        <a href="https://irons163.github.io/">
        
          Phil Chang
        
        </a>
      </span>
      
        
        
        
        <div class="author-image">
          <img src="https://irons163.github.io/aaa.jpg" alt="Author Image" class="img--circle img--headshot element--center">
        </div>
        
      
      
      <p class="site__description">
        
      </p>
    </div>
    <div class="collapsible-menu">
      <input type="checkbox" id="menuToggle">
      <label for="menuToggle">Phil Chang</label>
      <div class="menu-content">
        <div>
	<ul class="sidebar-nav">
		 
		 
			 
				<li>
					<a href="/post/">
						<span>Posts</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/portfolio/">
						<span>Portfolio</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/about/">
						<span>About Me</span>
					</a>
				</li>
			 
		
	</ul>
</div>

        <section class="social">
	
	
	
	<a href="https://facebook.com/100000231660391" rel="me"><i class="fab fa-facebook-f"></i></a>
	
	
	<a href="https://github.com/irons163" rel="me"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
	<a href="https://linkedin.com/in/phil-chang-29a5a01b3" rel="me"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a>
	
	
	
	<a href="https://stackoverflow.com/users/11916841/irons163" rel="me"><i class="fab fa-stack-overflow fa-lg" aria-hidden="true"></i></a>
	
	
	<a href="https://medium.com/@irons163" rel="me"><i class="fab fa-medium fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
	<a href="mailto:irons163" rel="me"><i class="fas fa-at fa-lg" aria-hidden="true"></i></a>
	
	
	
	
</section>

      </div>
    </div>
    
<div class="copyright">
  &copy; 2020 - 2021 Phil Chang
  
    <a href="https://creativecommons.org/licenses/by-sa/4.0">CC BY-SA 4.0</a>
  
</div>


<div class="builtwith">
Built with <a href="https://gohugo.io">Hugo</a> ❤️ <a href="https://github.com/htr3n/hyde-hyde">hyde-hyde</a>.
</div>


  </div>
</div>

        <div class="content container">
            
  <div class="post-list">
    
    
      
        
      
      <div class="post-list__item">
        <span class="item__title--big">
          <a href="/post/hugo%E6%9E%B6%E7%AB%99%E5%88%86%E4%BA%AB/" >Hugo架站分享</a>
        </span>
        <span class="item__date">
          Apr 25, 2021
        </span>
        <span >
        
        如果你想架站，現在早已經有一推網站可以讓你註冊個人部落格， 分享文章以及點點滴滴。
但是你是否曾經有覺得不安全過？畢竟你辛苦完成的照片及文章都在別人的伺服器上， 萬一網站倒閉、硬碟毀損或被駭客入侵，就有可能什麼都沒有了！
幸運的是，現在架設一個簡單的靜態網站一點都不難。 而且你可以保留全部的檔案在自家的電腦裡，若搭配本篇會一起介紹的Github網站， 等於又多了一個備份在雲端中，安全性大大提升。
現在開始正式介紹今天的主角：Hugo
Install 我的環境是MacOS，所以以下都用MacOS來解說，若是使用其他作業系統的朋友，可以透過連結去看官方安裝手冊：Hugo Install。
/bin/bash -c &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)&quot; Then
brew install hugo 
        
        </span>
        
        </div>
        
     
      
        
      
      <div class="post-list__item">
        <span class="item__title--big">
          <a href="/post/ios-face-track/" >iOS Face Track</a>
        </span>
        <span class="item__date">
          Apr 20, 2021
        </span>
        <span >
        
        How does it work?  Using VNDetectFaceLandmarksRequestRevision3  Starting with iOS 13, you will get a different set of points (VNDetectFaceLandmarksRequestRevision3)  Get size of camera layer.  AVCaptureVideoDataOutput *output = [[[self.videoCamera captureSession] outputs] lastObject]; NSDictionary* outputSettings = [output videoSettings]; long width = [[outputSettings objectForKey:@&#34;Width&#34;] longValue]; long height = [[outputSettings objectForKey:@&#34;Height&#34;] longValue];   Conver points
   Method one    size_t width = CVPixelBufferGetWidth(CVPixelBufferRef); size_t height = CVPixelBufferGetHeight(CVPixelBufferRef); CGSize size = CGSizeMake(width, height); CGFloat scaleX = self.
        
        </span>
        
          ... <a class="read-more-symbol" href="/post/ios-face-track/">➦</a>
        
        </div>
        
     
      
        
      
      <div class="post-list__item">
        <span class="item__title--big">
          <a href="/post/%E6%92%AD%E6%94%BE%E9%95%B7%E5%BA%A6%E8%88%87%E7%99%BE%E5%88%86%E6%AF%94%E8%A8%88%E7%AE%97/" >播放長度與百分比計算</a>
        </span>
        <span class="item__date">
          Apr 15, 2021
        </span>
        <span >
        
        總長度： _formatCtx-&gt;duration / AV_TIME_BASE;
當前frame的postion: avcodec_decode_video2(_videoCodecCtx, _videoFrame, &amp;gotframe, &amp;packet); float position = av_frame_get_best_effort_timestamp(_videoFrame) * _videoTimeBase;
當前播放百分比(0.0~1.0)： AVStream *st = _formatCtx-&gt;streams[_videoStream]; float start_time = st-&gt;start_time * _videoTimeBase; avcodec_decode_video2(_videoCodecCtx, _videoFrame, &amp;gotframe, &amp;packet); float position = av_frame_get_best_effort_timestamp(_videoFrame) * _videoTimeBase; float video_position = position - start_time; float video_duration = _formatCtx-&gt;duration / AV_TIME_BASE; float video_persent = video_position / video_duration;
以下資料也許可以幫到你： 官網的sample: http://ffmpeg.org/doxygen/trunk/examples.html 非官方ffmpeg-tutorial https://github.com/chelyaev/ffmpeg-tutorial/blob/master/tutorial03.c 別人寫的簡易ffmpeg+SDL(程式碼不多)： http://blog.csdn.net/leixiaohua1020/article/details/38868499
        
        </span>
        
        </div>
        
     
      
        
      
      <div class="post-list__item">
        <span class="item__title--big">
          <a href="/post/live555%E4%BB%8B%E7%B4%B9/" >live555介紹</a>
        </span>
        <span class="item__date">
          Mar 05, 2021
        </span>
        <span >
        
        這次是介紹偏向live555，但是live555實在是一個很大的專案， 所以我也只是看了其中一小部分。
這邊先介紹live555處理h264 video的部分：
-(void)HandleForH264Video:(const uint8_t *)frameData frameDataLength:(int)frameDataLength presentationTime:(struct timeval)presentationTime durationInMicroseconds:(unsigned int)duration 傳入data，顯示時間，顯示多久。
do { ...... } while (0); 這個迴圈的用途是用break時很好用，可以繼續往下執行。
int iType = frameData[0] &amp; 0x1f; if(iType == 0X1 &amp;&amp; frameData[1] == 0x88)//if nal type is non-idr but frame slice is i or si slice  iType = 0x5; VideoFrame *tmpVideoFrame=nil; if(iType == 0X7)//SPS  { if(m_SPSFrame.m_pRawData != NULL) // just need once  break; tmpType = @&#34;SPS&#34;; m_SPSFrame.m_intFrameType = SPS_FRAME; m_SPSFrame.
        
        </span>
        
          ... <a class="read-more-symbol" href="/post/live555%E4%BB%8B%E7%B4%B9/">➦</a>
        
        </div>
        
     
      
        
      
      <div class="post-list__item">
        <span class="item__title--big">
          <a href="/post/kxmovie%E5%95%8F%E9%A1%8C%E8%88%87%E8%A7%A3%E6%B3%95%E5%88%86%E4%BA%AB/" >kxmovie問題與解法分享</a>
        </span>
        <span class="item__date">
          Mar 03, 2021
        </span>
        <span >
        
        最近一直在研究kxmovie, ffmpeg,
在此將遇到的問題與解法分享給大家。
下載與編譯ffmpeg(在mac)： １． 根據官網的步驟來下載與編譯ffmpeg: https://trac.ffmpeg.org/wiki/CompilationGuide/MacOSX 下面是一個日文網站，算是比較詳細的介紹官網那些步驟： http://qiita.com/mito_log/items/4eb9049aa44631e8b0c7
如果執行以下這行時有問題： ./configure &ndash;prefix=/usr/local &ndash;enable-gpl &ndash;enable-nonfree &ndash;enable-libass &ndash;enable-libfdk-aac &ndash;enable-libfreetype &ndash;enable-libmp3lame &ndash;enable-libopus &ndash;enable-libtheora &ndash;enable-libvorbis &ndash;enable-libvpx &ndash;enable-libx264 &ndash;enable-libxvid 可以在前面加上： DYLD_LIBRARY_PATH=/usr/local/lib 變成： DYLD_LIBRARY_PATH=/usr/local/lib ./configure &ndash;prefix=/usr/local &ndash;enable-gpl &ndash;enable-nonfree &ndash;enable-libass &ndash;enable-libfdk-aac &ndash;enable-libfreetype &ndash;enable-libmp3lame &ndash;enable-libopus &ndash;enable-libtheora &ndash;enable-libvorbis &ndash;enable-libvpx &ndash;enable-libx264 &ndash;enable-libxvid
編譯完後．編譯好的檔案會在以下路徑裡： /usr/local/lib /usr/local/include
本方法較為麻煩，且編譯好的檔案也不是在原目錄旁， 推薦用方法2，腳本編譯。
2.本方法為腳本，下載後將ffmpeg專案丟到裡面(與build*ffmpeg.sh同一層)，然後執行腳本即可。 https://github.com/kewlbear/FFmpeg-iOS-build-script
遇到的問題： １．問題：ffmpeg player 播放過慢，會常常卡頓。
分析原因：ffmpeg playerg的播放流程是 1.用av_read_frame下載frame 2.avcodec_decode_video2和avcodec_decode_audio4進行decode 3.用OpenGL繪圖。這三個動作是循序執行的：1-&gt;2-&gt;3-&gt;1-&gt;2-&gt;3&hellip; 在網路不穩的情況(公司環境雜，網速漂移大)，會來不及執行１，因為此時１正在等２和３。
解決方法： 由原本的循序執行，改為非同步執行： 1,1,1,1,1,1,&hellip;&hellip;. 2,2,2,2,2,2,&hellip;&hellip;. 3,3,3,3,3,3,&hellip;&hellip;.
新增雙重buffer機制：用來緩存１與２的結果。
微調後目前的buffer機制： buffer1:min 30s, max 自動增大，直到收到記憶體不足警告後馬上停止增大。 buffer2:min 1s, max 5s。
        
        </span>
        
          ... <a class="read-more-symbol" href="/post/kxmovie%E5%95%8F%E9%A1%8C%E8%88%87%E8%A7%A3%E6%B3%95%E5%88%86%E4%BA%AB/">➦</a>
        
        </div>
        
     
      
        
      
      <div class="post-list__item">
        <span class="item__title--big">
          <a href="/post/android-ndk-opengl%E4%BB%8B%E7%B4%B9/" >Android NDK OpenGL介紹</a>
        </span>
        <span class="item__date">
          Feb 28, 2021
        </span>
        <span >
        
        現在來介紹Android NDK OpenGL 的 code，
這段code是出在這裡： http://blog.csdn.net/wangchenggggdn/article/details/8896453 本來想從ios的code來porting，不過人家有類似的android code，就直接拿來修改比較快。
#include &lt;jni.h&gt; #include &lt;android/log.h&gt;
#include &lt;GLES2/gl2.h&gt; #include &lt;GLES2/gl2ext.h&gt;
#include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;math.h&gt;
#include &ldquo;Shader.vert&rdquo; #include &ldquo;Shader.frag&rdquo;
#include &ldquo;SenaoCommon.h&rdquo;
這是開頭需要include沒什麼好講，主要要看的是 #include &ldquo;Shader.vert&rdquo; #include &ldquo;Shader.frag&rdquo; 這兩個會導入vertrice and fragment shader code，如下：
//Shader.vert文件内容 static const char* VERTEX_SHADER = &ldquo;attribute vec4 vPosition; \n&rdquo; &ldquo;attribute vec2 a_texCoord; \n&rdquo; &ldquo;varying vec2 tc; \n&rdquo; &ldquo;void main() \n&rdquo; &ldquo;{ \n&rdquo; &quot; gl_Position = vPosition; \n&quot; &quot; tc = a_texCoord; \n&quot; &ldquo;} \n&rdquo;;
        
        </span>
        
          ... <a class="read-more-symbol" href="/post/android-ndk-opengl%E4%BB%8B%E7%B4%B9/">➦</a>
        
        </div>
        
     
      
        
      
      <div class="post-list__item">
        <span class="item__title--big">
          <a href="/post/egl%E7%9B%B8%E9%97%9C%E7%9A%84%E7%B6%B2%E7%AB%99%E8%B3%87%E6%BA%90/" >EGL相關的網站資源</a>
        </span>
        <span class="item__date">
          Feb 17, 2021
        </span>
        <span >
        
        這邊附上跟EGL相關的網站，
https://www.khronos.org/registry/egl/sdk/docs/man/ 官網 http://www.cnblogs.com/kiffa/archive/2013/02/21/2921123.html
code: https://github.com/JimSeker/opengl/blob/master/eclipse/OpenGL/src/com/androidbook/opengl/BasicGL.java https://github.com/tsaarni/android-native-egl-example/blob/master/src/main/jni/renderer.cpp
日文的： https://sites.google.com/site/learningopengl/eglbasics
        
        </span>
        
        </div>
        
     
      
        
      
      <div class="post-list__item">
        <span class="item__title--big">
          <a href="/post/egl%E4%BB%8B%E7%B4%B9/" >EGL介紹</a>
        </span>
        <span class="item__date">
          Feb 15, 2021
        </span>
        <span >
        
        現在要介紹ＥＧＬ。
 WIKI介紹： EGL is an interface between Khronos rendering APIs (such as OpenGL, OpenGL ES or OpenVG) and the underlying native platformwindowing system. EGL handles graphics context management, surface/buffer binding, rendering synchronization, and enables &ldquo;high-performance, accelerated, mixed-mode 2D and 3D rendering using other Khronos APIs.&quot;[2] EGL is managed by the non-profit technology consortium Khronos Group.
  EGL 介紹
EGL 是為 OpenGL ES 提供平台獨立性而設計， 是 OpenGL ES 和底層 Native 平台視窗系統之間的接口。 OpenGL ES 為附加功能和可能的平台特性開發提供了擴展機制，但仍然需要一個可以讓 OpenGL ES 和本地視窗系統交互且平台無關的層。 OpenGL ES 本質上是一個圖形渲染管線的狀態機，而 EGL 則是用於監控這些狀態以及維護 Frame buffer 和其他渲染 Surface 的外部層。
        
        </span>
        
          ... <a class="read-more-symbol" href="/post/egl%E4%BB%8B%E7%B4%B9/">➦</a>
        
        </div>
        
     
      
        
      
      <div class="post-list__item">
        <span class="item__title--big">
          <a href="/post/kxmovie%E8%A7%A3%E6%9E%90%E4%BA%8C/" >kxmovie解析（二）</a>
        </span>
        <span class="item__date">
          Feb 13, 2021
        </span>
        <span >
        
        Set Program and Shader  GLuint ShaderProgram = glCreateProgram(); 創建一個program object，待會將所有的shaders連結到這個object上。 GLuint ShaderObj = glCreateShader(ShaderType); 創建兩個shader objects，GL_VERTEX_SHADER , GL_FRAGMENT_SHADER。
GLint status; const GLchar *sources = (GLchar *)shaderString.UTF8String; GLuint shader = glCreateShader(type); if (shader == 0 || shader == GL_INVALID_ENUM) { LoggerVideo(0, @&#34;Failed to create shader %d&#34;, type); return 0; } glShaderSource(shader, 1, &amp;sources, NULL); glCompileShader(shader); NSString *const vertexShaderString = SHADER_STRING ( attribute vec4 position; attribute vec2 texcoord; uniform mat4 modelViewProjectionMatrix; varying vec2 v_texcoord; void main() { gl_Position = modelViewProjectionMatrix * position; v_texcoord = texcoord.
        
        </span>
        
          ... <a class="read-more-symbol" href="/post/kxmovie%E8%A7%A3%E6%9E%90%E4%BA%8C/">➦</a>
        
        </div>
        
     
      
        
      
      <div class="post-list__item">
        <span class="item__title--big">
          <a href="/post/kxmovie%E8%A7%A3%E6%9E%90%E4%B8%80/" >kxmovie解析（一）</a>
        </span>
        <span class="item__date">
          Feb 12, 2021
        </span>
        <span >
        
        對kxmovie進行解析  解析１：   CAEAGLLayer  /* Set CAEAGLLayer */ CAEAGLLayer *eaglLayer = (CAEAGLLayer*) self.layer; eaglLayer.contentsScale = [[UIScreen mainScreen] scale]; eaglLayer.opaque = YES; eaglLayer.drawableProperties = [NSDictionary dictionaryWithObjectsAndKeys: [NSNumber numberWithBool:FALSE], kEAGLDrawablePropertyRetainedBacking, kEAGLColorFormatRGBA8, kEAGLDrawablePropertyColorFormat,nil]; _context = [[EAGLContext alloc] initWithAPI:kEAGLRenderingAPIOpenGLES2];  從UIView取得CAEAGLLayer，對CAEAGLLayer進行設置。 其中eaglLayer.contentsScale = [[UIScreen mainScreen] scale]; 讓畫面可以scale，如此畫面才會清晰。
[[EAGLContext alloc] initWithAPI:kEAGLRenderingAPIOpenGLES2]; 可以選擇OpenGL版本：
typedef NS_ENUM(NSUInteger, EAGLRenderingAPI) { kEAGLRenderingAPIOpenGLES1 = 1, kEAGLRenderingAPIOpenGLES2 = 2, kEAGLRenderingAPIOpenGLES3 = 3, }; Gen and bind buffers  /* Attaches an EAGLDrawable as storage for the OpenGL ES renderbuffer object bound to GL_RENDERBUFFER */ glGenFramebuffers(1, &amp;_framebuffer); glGenRenderbuffers(1, &amp;_renderbuffer); glBindFramebuffer(GL_FRAMEBUFFER, _framebuffer); glBindRenderbuffer(GL_RENDERBUFFER, _renderbuffer); [_context renderbufferStorage:GL_RENDERBUFFER fromDrawable:(CAEAGLLayer*)self.
        
        </span>
        
          ... <a class="read-more-symbol" href="/post/kxmovie%E8%A7%A3%E6%9E%90%E4%B8%80/">➦</a>
        
        </div>
        
     
  </div>
  

<ul class="pagination">
    
    <li class="page-item">
        <a href="/" class="page-link" aria-label="First"><span aria-hidden="true">&laquo;&laquo;</span></a>
    </li>
    
    <li class="page-item disabled">
    <a href="" class="page-link" aria-label="Previous"><span aria-hidden="true">&laquo;</span></a>
    </li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item active"><a class="page-link" href="/">1</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item"><a class="page-link" href="/page/2/">2</a></li>
    
    
    <li class="page-item">
    <a href="/page/2/" class="page-link" aria-label="Next"><span aria-hidden="true">&raquo;</span></a>
    </li>
    
    <li class="page-item">
        <a href="/page/2/" class="page-link" aria-label="Last"><span aria-hidden="true">&raquo;&raquo;</span></a>
    </li>
    
</ul>


        </div>
        
  
  <script defer src="https://use.fontawesome.com/releases/v5.12.1/js/all.js" integrity="sha384-ZbbbT1gw3joYkKRqh0kWyRp32UAvdqkpbLedQJSlnI8iLQcFVxaGyrOgOJiDQTTR" crossorigin="anonymous"></script>


    </body>
</html>
